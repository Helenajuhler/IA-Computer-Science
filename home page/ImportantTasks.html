<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="Stylesheet" href="ImportantTasks.css" />
  </head>
  <body>
    <nav>
      <a href="index.html" class="index-link">Home</a>
    </nav>

    <header>
      <h1>Important Tasks</h1>
      <form id="new-task-form">
        <input type="text" id="new-task-input" placeholder="add new task" />
        <input type="submit" id="new-task-submit" value="Add task" />
      </form>
    </header>

    <main>
      <section class="task-list">
        <h2>Tasks</h2>
        <div id="tasks">
          <div class="task">
            <div class="content">
              <input type="text" class="text" value="my task" readonly />
            </div>
            <div class="actions">
              <button class="edit">edit</button>
              <button class="delete">delete</button>
            </div>
          </div>
        </div>
      </section>
    </main>

    <script type="module">
      // Import the functions you need from the SDKs you need
      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
      import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-analytics.js";
      // TODO: Add SDKs for Firebase products that you want to use
      // https://firebase.google.com/docs/web/setup#available-libraries

      // Your web app's Firebase configuration
      // For Firebase JS SDK v7.20.0 and later, measurementId is optional
      const firebaseConfig = {
        apiKey: "AIzaSyCHnta7PptzHko_EBht5H52oRSbT67xuB0",
        authDomain: "computer-science-ia-bba75.firebaseapp.com",
        projectId: "computer-science-ia-bba75",
        storageBucket: "computer-science-ia-bba75.appspot.com",
        messagingSenderId: "863859461520",
        appId: "1:863859461520:web:1f24e37a56dd011ff77715",
        measurementId: "G-BH4Q0JCDNZ",
      };

      window.addEventListener("load", () => {
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);

        const form = document.querySelector("#new-task-form");
        const input = document.querySelector("#new-task-input");
        const list_el = document.querySelector("#tasks");

        form.addEventListener("submit", (e) => {
          e.preventDefault();

          const task = input.value;

          if (!task) {
            alert("Add a task");
            return;
          }

          const task_el = document.createElement("div");
          task_el.classList.add("task");

          const task_content_el = document.createElement("div");
          task_content_el.classList.add("content");

          task_el.appendChild(task_content_el);

          const task_input_el = document.createElement("input");
          task_input_el.classList.add("text");
          task_input_el.type = "text";
          task_input_el.value = task;
          task_input_el.setAttribute("readonly", "readonly");

          task_content_el.appendChild(task_input_el);

          const task_actions_el = document.createElement("div");
          task_actions_el.classList.add("actions");

          const task_edit_el = document.createElement("button");
          task_edit_el.classList.add("edit");
          task_edit_el.innerHTML = "Edit";

          const task_delete_el = document.createElement("button");
          task_delete_el.classList.add("delete");
          task_delete_el.innerHTML = "Delete";

          task_actions_el.appendChild(task_edit_el);
          task_actions_el.appendChild(task_delete_el);

          task_el.appendChild(task_actions_el);

          list_el.appendChild(task_el);

          input.value = "";

          task_edit_el.addEventListener("click", () => {
            if (task_edit_el.innerText.toLowerCase() == "edit") {
              task_input_el.removeAttribute("readonly");
              task_input_el.focus();
              task_edit_el.innerText = "Save";
            } else {
              task_input_el.setAttribute("readonly", "readonly");
              task_edit_el.innerText = "Edit";
            }
          });

          task_delete_el.addEventListener("click", () => {
            list_el.removeChild(task_el);
          });
        });
      });
    </script>
  </body>
</html>
